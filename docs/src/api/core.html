<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Core</title>
    <meta name="generator" content="VuePress 1.6.0">
    
    <meta name="description" content="">
    <link rel="preload" href="/assets/css/0.styles.1c0d0795.css" as="style"><link rel="preload" href="/assets/js/app.1dffbeb3.js" as="script"><link rel="preload" href="/assets/js/2.cf0af338.js" as="script"><link rel="preload" href="/assets/js/9.b94037fb.js" as="script"><link rel="prefetch" href="/assets/js/10.a8ddb4b9.js"><link rel="prefetch" href="/assets/js/11.9dd42bba.js"><link rel="prefetch" href="/assets/js/12.cf0c23a6.js"><link rel="prefetch" href="/assets/js/13.e07d9dfd.js"><link rel="prefetch" href="/assets/js/14.78b37b4b.js"><link rel="prefetch" href="/assets/js/15.b03b7b7b.js"><link rel="prefetch" href="/assets/js/16.f5c41468.js"><link rel="prefetch" href="/assets/js/17.137e287c.js"><link rel="prefetch" href="/assets/js/18.7b40d60c.js"><link rel="prefetch" href="/assets/js/19.aef59784.js"><link rel="prefetch" href="/assets/js/3.c1ff3a62.js"><link rel="prefetch" href="/assets/js/4.47a91bbd.js"><link rel="prefetch" href="/assets/js/5.3b1ff64e.js"><link rel="prefetch" href="/assets/js/6.e416f727.js"><link rel="prefetch" href="/assets/js/7.5b9ae2ff.js"><link rel="prefetch" href="/assets/js/8.522eed0c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1c0d0795.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="core"><a href="#core" class="header-anchor">#</a> Core</h1> <h2 id="replaybg"><a href="#replaybg" class="header-anchor">#</a> replayBG</h2> <div class="language-matlab extra-class"><pre class="language-matlab"><code><span class="token keyword">function</span> <span class="token function">replayBG</span><span class="token punctuation">(</span>modality<span class="token punctuation">,</span> data<span class="token punctuation">,</span> BW<span class="token punctuation">,</span> saveName<span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'glucoseModel'</span><span class="token punctuation">,</span> <span class="token string">'IG'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'sampleTime'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'seed'</span><span class="token punctuation">,</span><span class="token function">randi</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">1048576</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'maxETAPerMCMCRun'</span><span class="token punctuation">,</span> <span class="token keyword">inf</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'maxMCMCIterations'</span><span class="token punctuation">,</span> <span class="token keyword">inf</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'maxMCMCRuns'</span><span class="token punctuation">,</span> <span class="token keyword">inf</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'maxMCMCRunsWithMaxETA'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'MCMCTheta0Policy'</span><span class="token punctuation">,</span> <span class="token string">'mean'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'bayesianEstimator'</span><span class="token punctuation">,</span> <span class="token string">'mean'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'preFilterData'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'saveChains'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'enableHypoTreatments'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'hypoTreatmentsHandler'</span><span class="token punctuation">,</span> <span class="token string">'adaHypoTreatmentsHandler'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'enableCorrectionBoluses'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'correctionBolusesHandler'</span><span class="token punctuation">,</span> <span class="token string">'correctsAbove250Handler'</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'saveSuffix'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'plotMode'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">...</span>
<span class="token string">'verbose'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">)</span>
</code></pre></div><p>Core function of ReplayBG. It is used to identify ReplayBG model on the
given data or to &quot;replay&quot; specific scenarios specified by the given <code>data</code>.</p> <h3 id="inputs"><a href="#inputs" class="header-anchor">#</a> Inputs</h3> <ul><li><strong>modality: vector of char, {'identification', 'replay'} (required)</strong> <br>
Specifies if the function will be used to identify the ReplayBG model on the given data
or to replay the scenario specified by the given data;</li> <li><strong>data: timetable, (required)</strong> <br>
A timetable which contains the data to be used by ReplayBG. MUST contain a column named 'glucose' that contains the glucose measurements (in mg/dl), a column named 'basal' that contains the basal insulin data (in U/min), a column 'bolus' that contains the bolus insulin data (in U/min), a column 'CHO' that contains the CHO intake data (in g/min). <strong>data</strong> MUST be sampled on a homogeneous time grid and MUST not contain Nan values;</li> <li><strong>BW: double, (required)</strong> <br>
The patient body weight (kg);</li> <li><strong>saveName: vector of char, (required)</strong> <br>
A vector of characters used to label, thus identify, each output file and result;</li> <li><strong>glucoseModel: vector of char, {'BG', 'IG'}, default: 'IG'</strong> <br>
A vector of characters that specifies the glucose model to use. Specifying 'BG', ReplayBG will use the blood glucose as measurement model. Specifying 'IG', ReplayBG will use the interstitial glucose as measurement model;</li> <li><strong>sampleTime: integer, default: 5</strong> <br>
An integer that specifies the sample time (min) of the <strong>data</strong> timetable;</li> <li><strong>seed: integer, default: randi([1 1048576])</strong> <br>
An integer that specifies the random seed. For reproducibility;</li> <li><strong>maxETAPerMCMCRun: double, default: inf</strong> <br>
A number that specifies the maximum time (hour) allowed for each MCMC run. Ignored when <strong>modality</strong> is 'replay';</li> <li><strong>maxMCMCIterations: integer, default: inf</strong> <br>
An integer that specifies the maximum number of iterations for each MCMC run. Ignored when <strong>modality</strong> is 'replay';</li> <li><strong>maxMCMCRuns: integer, default: inf</strong> <br>
An integer that specifies the maximum number of MCMC runs. Ignored when <strong>modality</strong> is 'replay';</li> <li><strong>maxMCMCRunsWithMaxETA: integer, default: 2</strong> <br>
An integer that specifies the maximum number of MCMC runs having maximum ETA. Ignored when <strong>modality</strong> is 'replay';</li> <li><strong>MCMCTheta0Policy: vector of char, {'mean', 'initial', 'last'}, default: 'mean'</strong> <br>
A vector of characters defining the policy used by the MCMC procedure to set the initial MCMC chain values. Using 'mean', the mean value of the MCMC chain obtained from the last MCMC run will be set as initial MCMC chain value to be used in the next MCMC run. Using 'last', the last value of the MCMC chain obtained from the last MCMC run will be set as initial MCMC chain value to be used in the next MCMC run. Using 'initial', the same initial value will be used for every run of MCMC. Ignored when <strong>modality</strong> is 'replay';</li> <li><strong>bayesianEstimator: vector of char, {'mean', 'map'}, default: 'mean'</strong> <br>
A vector of characters defining which Bayesian estimator to use to obtain a point estimate of model parameters. Using 'mean' the posterior mean estimater will be used. Using 'map', the marginalized maximum-a-posteriori estimator will be used. Ignored when <strong>modality</strong> is 'replay';</li> <li><strong>preFilterData: integer, {0, 1}, default: 0</strong> <br>
A numerical flag that specifies whether to filter the glucose data before performing the model identification or not. This might help the identification procedure. Filtering is performed using a non-causal fourth-order Butterworth filter having 0.1*sampleTime cutOff frequency. Ignored when <strong>modality</strong> is 'replay';</li> <li><strong>saveChains: integer, {0, 1}, default: 1</strong> <br>
A numerical flag that specifies whether to save the resulting MCMC chains in dedicated files (one for each MCMC run) for future analysis or not. Ignored when <strong>modality</strong> is 'replay';</li> <li><strong>enableHypoTreatments: integer, {0, 1}, default: 0</strong> <br>
A numerical flag that specifies whether to enable hypotreatments during the replay of a given scenario. Can be set only when <strong>modality</strong> is 'replay';</li> <li><strong>hypoTreatmentsHandler: vector of char, default:   'adaHypoTreatmentsHandler'</strong> <br>
A vector of characters that specifies the name of the function handler that implements an hypotreatment strategy during the replay of a given scenario. The function must have 1 output, i.e., the hypotreatments carbohydrates intake (g/min). The function must accept 6 inputs, i.e., 'G' (mg/dl) the glucose concentration at time(timeIndex), 'CHO' (g/min) a vector that contains the CHO intakes input for the whole replay simulation, 'bolus' (U/min) a vector that contains the bolus insulin input for the whole replay simulation, 'basal' (U/min) a vector that contains the basal insulin input for the whole replay simulation, 'time' (datetime) a vector that contains the time istants of current replay simulation, 'timeIndex' is a number that defines the current time istant in the replay simulation. Vectors contain one value for each integration step. The default policy, implemented by the function 'adaHypoTreatmentHandler', is &quot;take an hypotreatment of 10 g every 15 minutes while in hypoglycemia&quot;;</li> <li><strong>enableCorrectionBoluses: integer, {0, 1}, default: 0</strong> <br>
A numerical flag that specifies whether to enable correction boluses during the replay of a given scenario. Can be set only when <strong>modality</strong> is 'replay';</li> <li><strong>correctionBolusesHandler: vector of char, default:   'correctsAbove250Handler'</strong> <br>
A vector of characters that specifies the ame of the function handler that implements a corrective bolusing strategy during the replay of a given scenario. The function must have 1 output, i.e., the correction insulin bolus (U/min). The function must accept 6 inputs, i.e., 'G' (mg/dl) the glucose concentration at time(timeIndex), 'CHO' (g/min) a vector that contains the CHO intakes input for the whole replay simulation, 'bolus' (U/min) a vector that contains the bolus insulin input for the whole replay simulation, 'basal' (U/min) a vector that contains the basal insulin input for the whole replay simulation, 'time' (datetime) a vector that contains the time istants of current replay simulation, 'timeIndex' is a number that defines the current time istant in the replay simulation. Vectors contain one value for each integration step. The default policy, implemented by the function 'correctsAbove250Handler', is &quot;take a corrective bolus of 1 U every 1 hour while above 250 mg/dl&quot;;</li> <li><strong>saveSuffix: vector of characters, default: ''</strong> <br>
A vector of char to be attached as suffix to the resulting output files' name;</li> <li><strong>plotMode: integer, {0, 1}, default: 1</strong> <br>
A numerical flag that specifies whether to show the plot of the results or not;</li> <li><strong>verbose: integer, {0, 1}, default: 1</strong> <br>
A numerical flag that specifies the verbosity of ReplayBG.</li></ul> <h3 id="results"><a href="#results" class="header-anchor">#</a> Results</h3> <p>Results are saved in the <strong>results/</strong> folder, specifically:</p> <ul><li><strong>results/distributions/</strong>: contains the identified ReplayBG model parameter distributions obtained via MCMC;</li> <li><strong>results/logs/</strong>: contains .txt files that log the command window output of ReplayBG. Of note, .txt files will be empty if verbose = 0;</li> <li><strong>results/mcmcChains/</strong>: if <strong>saveChains = 1</strong>, contains the MCMC chains, for each unknown parameter, obtained in each MCMC run;</li> <li><strong>results/modelParameters/</strong>: contains the model parameters identified using MCMC. Known model parameters are fixed to population values obtained from the literature. Unknown model parameters are pointly estimated using the estimator specified by <strong>bayesianEstimator</strong>;</li> <li><strong>results/workspaces/</strong>: contains the core ReplayBG variables and data used in a specific ReplayBG call.</li></ul> <h2 id="note-on-the-function-handlers"><a href="#note-on-the-function-handlers" class="header-anchor">#</a> Note on the function handlers</h2> <ul><li>Integration step is 1 minute. Function handlers of the integrated
decision support systems works at this time step. So, input vectors of
the function handlers contain one value for each integration step.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1dffbeb3.js" defer></script><script src="/assets/js/2.cf0af338.js" defer></script><script src="/assets/js/9.b94037fb.js" defer></script>
  </body>
</html>
